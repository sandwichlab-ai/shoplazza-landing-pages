{% assign enable_stack_on_mobile = section.settings.enable_stack_on_mobile %}
{% assign block_size = section.blocks.size %}
{% include 'card_spacing_css' %}

{% if section.settings.enable_custom_color %}
  {% assign background_color = section.settings.background_color | default: "#FFFFFF" %}
{% else %}
  {% assign background_color = settings.color_general_bg %}
{% endif %}

<style>
  [data-section-id="{{ section.id }}"] {
    background: {{ background_color }};
  }
  [data-section-id="{{ section.id }}"] .icon_text_container {
    padding-top: 40px;
    padding-bottom: 40px;
  }
  [data-section-id="{{ section.id }}"] .icon_text_wrapper {
    display: grid;
    grid-template-columns: repeat({{block_size}},minmax(0, 1fr));
    color: var(--color-body-text);
    gap: 24px;
  }

  [data-section-id="{{ section.id }}"] .icon_text_title {
    font-size: calc(var(--type-heading-font-size) * .93);
    margin-bottom: 80px;
    color: var(--color-general-heading-text);
  }

  [data-section-id="{{ section.id }}"] .icon_text_title p {
    margin: 0;
  }

  [data-section-id="{{ section.id }}"] .icon_text_heading {
    font-size: calc(var(--type-heading-font-size) * .8);
    margin-top: 16px;
  }

  [data-section-id="{{ section.id }}"] .icon_text_desc {
    font-size: calc(var(--type-text-font-size) + 2px);
    margin-top: 8px;
  }

  [data-section-id="{{ section.id }}"] .single_icon {
    /* padding: 24px 0; */
  }

  [data-section-id="{{ section.id }}"] .icon_link_wrapper {
    text-decoration: none;
    color: var(--color-body-text);
  }
  [data-section-id="{{ section.id }}"] .icon_text_icon svg{
    width: 36px;
    height: 36px;
  }

  @media (max-width: {{ settings.breakpoint }}px) {
    [data-section-id="{{ section.id }}"] .icon_text_container {
      padding-top: 20px;
      padding-bottom: 20px;
    }
    [data-section-id="{{ section.id }}"] .icon_text_wrapper {
      gap: 24px;
    }

    [data-section-id="{{ section.id }}"] .icon_text_title {
      font-size: calc(var(--type-heading-font-size) * .8);
      margin-bottom: 20px;
    }

    [data-section-id="{{ section.id }}"] .icon_text_icon svg {
      transform: {% unless enable_stack_on_mobile %}scale(0.55){% endunless %};
    }

    [data-section-id="{{ section.id }}"] .single_icon img {
      transform: {% unless enable_stack_on_mobile %}scale(0.55){% endunless %};
    }

    [data-section-id="{{ section.id }}"] .icon_text_heading {
      font-size: {% if enable_stack_on_mobile %}calc(var(--type-heading-font-size) * .8){% else %}calc(var(--type-heading-font-size) * .4){% endif %};
    }

    [data-section-id="{{ section.id }}"] .icon_text_desc {
      display: {% if enable_stack_on_mobile %}block{% else %}none{% endif %};
      margin-top: 4px;
      line-height: 1.3;
    }

    [data-section-id="{{ section.id }}"] .icon_text_wrapper {
      grid-template-columns: {% if enable_stack_on_mobile %}1fr{% else %}repeat({{block_size}},minmax(0, 1fr)){% endif %};
    }
  }
</style>

<div class="page-container icon_text_container">
  {% if section.settings.icon_title %}
    <div class="text-center icon_text_title break-words">{{ section.settings.icon_title }}</div>
  {% endif %}
  <div class='icon_text_wrapper'>
    {% for block in section.blocks %}
      {% assign icon = block.settings.icon %}
      {% assign heading = block.settings.heading %}
      {% assign text = block.settings.text %}
      {% assign link = block.settings.link.url %}
      {% assign image = block.settings.image %}
      <div class='single_icon'>
        <a class="flex flex-col items-center text-center icon_link_wrapper" {% include 'link', link %}>
          {% if image %}
            <spz-img
              {% unless enable_stack_on_mobile %}
                class="md:hidden"
              {% endunless %}
              layout="fixed"
              width="36"
              height="36"
              src="{{ image | img_url }}"
              alt="{{ images[image].alt | default: heading | escape }}"
              object-fit="contain"
              auto-fit
            ></spz-img>
            {% unless enable_stack_on_mobile %}
              <spz-img
                class="lg:hidden"
                layout="fixed"
                width="36"
                height="36"
                src="{{ image | img_url }}"
                alt="{{ images[image].alt | default: heading | escape }}"
                object-fit="contain"
                auto-fit
              ></spz-img>
            {% endunless %}
          {% else %}
            <i class='icon_text_icon'>
              {% case icon %}
                {% when 'free_shipping' %}
                  {% include 'icon_free_shipping' %}
                {% when 'customer_service' %}
                  {% include 'icon_service' %}
                {% when 'secure_payment' %}
                  {% include 'icon_payment' %}
                {% when 'fast_delivery' %}
                  {% include 'icon_delivery' %}
                {% when 'contact_us' %}
                  {% include 'icon_contact' %}
                {% when 'credit_card' %}
                  {% include 'icon_credit' %}
                {% when 'returns' %}
                  {% include 'icon_returns' %}
                {% when 'sale' %}
                  {% include 'icon_sale' %}
                {% when 'natural' %}
                  {% include 'icon_natural' %}
                {% when 'compostable' %}
                  {% include 'icon_compostable' %}
                {% when 'recyclable' %}
                  {% include 'icon_recyclable' %}
                {% when 'vegan' %}
                  {% include 'icon_vegan' %}
              {% endcase %}
            </i>
          {% endif %}
          {% if heading %}
            <div class='icon_text_heading'>{{ heading }}</div>
          {% endif %}
        </a>
        {% if text %}
          <div class='icon_text_desc text-center'>{{ text }}</div>
        {% endif %}
      </div>
    {% endfor %}
  </div>
</div>

{% schema %}
{
  "name": "icon_text",
  "max_blocks": 4,
  "settings": [
    {
      "type": "richtext",
      "id": "icon_title",
      "label": {
        "zh-CN": "标题",
        "en-US": "Title"
      }
    },
    {
      "type": "checkbox",
      "id": "enable_custom_color",
      "label": {
        "en-US": "Custom color",
        "zh-CN": "自定义颜色"
      },
      "default": false
    },
    {
      "type": "color",
      "id": "background_color",
      "label": {
        "en-US": "Background",
        "zh-CN": "背景"
      },
      "visibleOn": "enable_custom_color",
      "default": "#FFFFFF"
    },
    {
      "type": "checkbox",
      "id": "enable_stack_on_mobile",
      "label": {
        "en-US": "Vertical layout on mobile",
        "zh-CN": "移动端纵向排列"
      },
      "default": false
    },
    {
      "type": "spacing",
      "id": "spacing",
      "label": {
        "en-US": "Spacing",
        "zh-CN": "间距留白"
      },
      "pc": {
        "top": "40",
        "right": "",
        "bottom": "40",
        "left": ""
      },
      "mobile": {
        "top": "20",
        "right": "",
        "bottom": "20",
        "left": ""
      },
      "default": {
        "pc": {
          "top": "40",
          "right": "",
          "bottom": "40",
          "left": ""
        },
        "mobile": {
          "top": "20",
          "right": "",
          "bottom": "20",
          "left": ""
        }
      }
    }
  ],
  "blocks": [
    {
      "type": "icon",
      "limit": 4,
      "name": {
        "en-US": "Icon",
        "zh-CN": "图标"
      },
      "settings": [
        {
          "type": "select",
          "id": "icon",
          "label": {
            "en-US": "Select icon",
            "zh-CN": "选择图标"
          },
          "options": [
            {
              "value": "natural",
              "label": {
                "en-US": "Natural",
                "zh-CN": "纯天然"
              }
            },
            {
              "value": "compostable",
              "label": {
                "en-US": "Compostable",
                "zh-CN": "环保"
              }
            },
            {
              "value": "recyclable",
              "label": {
                "en-US": "Recyclable",
                "zh-CN": "可循环"
              }
            },
            {
              "value": "vegan",
              "label": {
                "en-US": "Vegan",
                "zh-CN": "素食"
              }
            },
            {
              "value": "customer_service",
              "label": {
                "en-US": "Customer service",
                "zh-CN": "客服"
              }
            },
            {
              "value": "contact_us",
              "label": {
                "en-US": "Contact us",
                "zh-CN": "联系我们"
              }
            },
            {
              "value": "free_shipping",
              "label": {
                "en-US": "Free shipping",
                "zh-CN": "免邮"
              }
            },
            {
              "value": "fast_delivery",
              "label": {
                "en-US": "Fast delivery",
                "zh-CN": "快速发货"
              }
            },
            {
              "value": "secure_payment",
              "label": {
                "en-US": "Secure payment",
                "zh-CN": "安全支付"
              }
            },
            {
              "value": "credit_card",
              "label": {
                "en-US": "Credit card",
                "zh-CN": "信用卡"
              }
            },
            {
              "value": "sale",
              "label": {
                "en-US": "Sale",
                "zh-CN": "折扣"
              }
            },
            {
              "value": "returns",
              "label": {
                "en-US": "14-Day returns",
                "zh-CN": "14天退货"
              }
            }
          ],
          "default": "fast_delivery"
        },
        {
          "type": "image_picker",
          "resource_type": {
            "design": {
              "dimensions": {
                "units": "px",
                "height": 36,
                "width": 36
              }
            }
          },
          "id": "image",
          "label": {
            "en-US": "Upload",
            "zh-CN": "本地上传"
          },
          "info": {
            "en-US": "36 x 36px recommended. Uploading an image will override any icon selected above.",
            "zh-CN": "推荐尺寸：36px*36px，若已本地上传图标，上方已选择图标将不展示"
          }
        },
        {
          "type": "text",
          "id": "heading",
          "label": {
            "en-US": "Heading",
            "zh-CN": "标题"
          },
          "default": "Free delivery worldwide"
        },
        {
          "type": "textarea",
          "id": "text",
          "label": {
            "en-US": "Text",
            "zh-CN": "文字"
          },
          "default": "Short content about your store"
        },
        {
          "type": "url",
          "id": "link",
          "label": {
            "en-US": "Link",
            "zh-CN": "链接"
          },
          "default": ""
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "icon_text",
      "cname": {
        "zh-CN": "图标文字",
        "en-US": "Text with icons"
      },
      "category": {
        "en-US": "Image with text",
        "zh-CN": "图文"
      },
      "ccategory": {
        "en-US": "Image with text",
        "zh-CN": "图文"
      },
      "icon": "oss/operation/b3117ddd140480a503655c157b1af934.svg",
      "display": true,
      "blocks": [
        {
          "type": "icon",
          "settings": {
            "icon": "free_shipping",
            "heading": "Free shipping",
            "text": "Short content about your store"
          }
        },
        {
          "type": "icon",
          "settings": {
            "icon": "customer_service",
            "heading": "Customer service",
            "text": "Short content about your store"
          }
        },
        {
          "type": "icon",
          "settings": {
            "icon": "secure_payment",
            "heading": "Secure payment",
            "text": "Short content about your store"
          }
        },
        {
          "type": "icon",
          "settings": {
            "icon": "contact_us",
            "heading": "Contact us",
            "text": "Short content about your store"
          }
        }
      ]
    }
  ]
}
{% endschema %}
